<script lang="ts">
  import { page } from "$app/stores";
  import GoogleMaps from "$components/GoogleMaps.svelte";
  import Login from "$components/modals/Login.svelte";
  import Locate from "$components/svg/Locate.svelte";
  import mapStore from "$stores/map";
  import type { PageData } from "./$types";
  export let data: PageData;

  function initHunt() {
    const { markers } = data;
    mapStore.setMarkers(markers);
  }
  $: {
    console.log("+page.svelte, $page.data:", $page.data);
  }

  let showModal = false;
</script>

<button
  on:click={() => {
    showModal = true;
  }}
  class="lat-lng">{JSON.stringify($mapStore.userMarker?.getPosition())} - {$page.data.hunter || "not logged in"}</button
>
<Login bind:showModal />
<GoogleMaps
  globally
  on:load={(e) => {
    initHunt();
    console.log("+page.svelte:Map Loaded");
  }}
/>
<button class="user-position" on:click={() => mapStore.trackUser()}><Locate /></button>

<style>
  .lat-lng {
    position: absolute;
    left: 10px;
    top: 10px;
    color: red;
    z-index: 99;
  }
  .user-position {
    position: absolute;
    right: 10px;
    bottom: 10px;
    z-index: 9;
    width: 80px;
    height: 80px;
    background: rgb(255, 0, 162);
    border-radius: 50%;
    border: 10px solid white;
  }
</style>
